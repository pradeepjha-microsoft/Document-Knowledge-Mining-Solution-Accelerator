name: CodeQL

on:
  push:
    branches: 
      - main  # Specify your target branch for analysis (main or master)
  pull_request:
    branches:
      - main

jobs:
  analysis:
    runs-on: ubuntu-latest  # You can also use other OS types, like 'windows-latest' or 'macos-latest'

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Set up .NET SDK
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: '6.0'  # Specify the version of .NET Core you are using

    - name: Install dependencies
      run: |
        dotnet restore  # Restore the NuGet packages

    - name: Build project
      run: |
        dotnet build --configuration Release --no-restore  # Build the project without restoring dependencies again

    - name: Initialize CodeQL
      uses: github/codeql-action/init@v2
      with:
        languages: 'csharp'  # Specify 'csharp' for .NET Core

    - name: Perform CodeQL Analysis
      uses: github/codeql-action/analyze@v2
      with:
        category: 'security'